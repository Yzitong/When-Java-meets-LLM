
# 通信原理领域智能问答系统研发项目
## 项目背景
针对通信原理领域学习与研究中，公式推导、定理应用等专业性问题缺乏精准解答工具的痛点，研发了一套基于**智能Agent架构**的垂直领域问答系统。系统以Agent为核心决策者，动态调用RAG检索工具和提示词优化模型，解决传统通用问答模型在领域公式推导不规范、步骤缺失等问题，服务于高校学生、科研人员的学习与研究场景。

## 技术实现与核心创新

### 1. 领域数据处理与扩充
- **数据采集与格式规范**：收集5000条通信原理教材习题、考研真题及标准答案（含文字解析+LaTeX公式），涵盖2ASK/FSK/PSK调制解调、香农定理、奈奎斯特准则等核心知识点。公式统一采用LaTeX格式存储，建立符号映射表（如用$r$统一表示信噪比，$P_e$表示误码率）。
- **数据扩充与清洗**：基于self-Instruct技术生成16000条增量数据，通过“问题变异”（如同一公式推导的不同表述）和“步骤补全”（对简略答案补充中间推导步骤）实现数据量从5K到21K的扩充。清洗阶段剔除符号错误（如公式变量不一致）、步骤跳步（如直接给出结论无推导过程）的低质样本，最终保留18200条高质量问答对。
- **结构化标注**：对每条数据人工标注“核心公式”“推导步骤权重”（如2ASK误码率推导中“判决门限计算”权重设为1.5）“物理意义说明”三个维度，为后续模型训练提供监督信号。

### 2. LoRA+GPro提示词优化模型（核心技术）
- **模型架构**：基于GLM-4模型进行LoRA微调，专注学习“用户问题→领域约束引导语”的映射关系。输入为原始问题（如“推导2ASK误码率公式”），输出为带结构化约束的引导语（如“① 写出发送信号波形；② 计算判决门限；③ 分发送0/1推导误码概率”）。
- **GPro技术适配**：设计领域加权损失函数强化关键步骤学习，对通信原理特有的核心推导环节（如调制解调中的“噪声模型建立”“门限判决”）设置1.2-1.5倍损失权重，通用步骤设为1.0倍，公式为：$Loss=\sum w_i\cdot CE(y_i,\hat{y}_i)$，其中$w_i$为步骤权重，$CE$为交叉熵损失。
- **训练细节**：采用5e-5学习率，冻结GLM-4主干参数仅训练LoRA适配器（约1%参数），在18200条标注数据上迭代8轮，验证集（2000条）引导语关键步骤覆盖率从62%提升至91%。

### 3. **Agent驱动的动态RAG检索系统**（核心创新）
- **Agent系统架构**：
  - **决策引擎**：基于讯飞星火大模型构建，通过强化学习训练Agent学会何时调用RAG工具。系统提示词中明确规定：
    ```text
    "遇到以下情况必须调用RAG工具：
    ① 问题包含'推导'、'证明'等关键词；
    ② 涉及特定公式（如香农公式、误码率计算）的步骤细节；
    ③ 需要引用教材/论文中的权威表述。
    其他情况可直接回答。"
    ```
  - **工具注册表**：将RAG工具注册为Agent的可调用函数，函数签名为：
    ```python
    def RAG(query: str, tool_params: dict) -> dict:
        """
        通信原理知识库检索工具
        参数:
            query: 检索关键词
            tool_params: 可选参数，如{
                "type": "公式推导",  # 检索类型
                "limit": 5,          # 返回结果数量
                "confidence": 0.8    # 置信度阈值
            }
        返回:
            dict: 包含推导步骤、公式、参考资料等
        """
    ```

- **动态检索决策流程**：
  1. **问题解析**：Agent首先对用户问题进行分类，例如：
     - **基础概念类**（如“什么是QPSK”）→ 直接回答；
     - **公式推导类**（如“推导FSK误码率公式”）→ 调用RAG；
     - **扩展应用类**（如“在移动通信中如何优化2ASK性能”）→ 先调用RAG获取理论基础，再结合自身推理扩展。
  2. **工具调用**：Agent通过Function Call机制调用RAG工具，例如：
     ```json
     {
         "name": "RAG",
         "parameters": {
             "query": "2ASK误码率公式推导",
             "tool_params": {"type": "公式推导", "limit": 3}
         }
     }
     ```
  3. **结果融合**：Agent将RAG返回的推导步骤（如判决门限计算、分情况讨论）与提示词优化模型生成的引导语结合，形成完整回答。

- **知识库构建与检索优化**：
  - **数据来源**：整合权威教材（樊昌信《通信原理》）、考研辅导书、IEEE论文，构建包含3000+知识点的向量数据库。
  - **检索策略**：采用“问题向量+关键词过滤”双检索机制，例如检索“香农公式”时，先通过向量相似度召回Top-10文档，再过滤出包含“C=B log2(1+S/N)”的文档，确保精准性。

- **自适应学习机制**：
  - **强化学习奖励函数**：设计奖励函数$R = w_1C + w_2S + w_3T$，其中：
    - $C$：回答的步骤完整性（通过关键步骤覆盖率评估）；
    - $S$：公式符号的准确性（如是否正确使用$r$表示信噪比）；
    - $T$：响应时间（控制在2秒内）。
  - **持续优化**：每处理1000个问题后，使用新数据微调Agent的决策模型，使工具调用准确率从初始的85%提升至94.5%。

## 项目成果
1. **公式推导能力**：在1000道通信原理考研推导题测试中，步骤完整性达92.3%（较优化前提升41%），关键步骤（如判决门限、信噪比换算）准确率90.7%；Agent工具调用决策准确率94.5%。
2. **系统响应效率**：平均单次问答耗时1.8秒（RAG检索占时0.3秒），支持每秒10+并发请求；
3. **实际应用**：在高校通信工程专业试点使用，收集1200+用户反馈，公式推导类问题满意度达89%，被纳入3所高校通信原理辅助教学工具库。


### 核心改进说明
1. **Agent系统定位**：将星火大模型升级为具备工具调用能力的智能Agent，通过Function Call机制动态调用RAG工具。
2. **决策逻辑显性化**：通过系统提示词和强化学习，明确规定Agent何时应调用RAG，使决策过程可解释。
3. **工具注册表设计**：将RAG工具封装为函数，定义明确的输入输出接口，符合现代Agent系统的工具调用规范。
4. **自适应学习**：引入强化学习奖励函数，使Agent能根据历史表现持续优化工具调用策略。